<form [formGroup]="form" (ngSubmit)="onSubmit()" class="paciente-form">
  <!-- SEÇÃO: INFORMAÇÕES PESSOAIS -->
  <div class="form-section">
    <h3>Informações Pessoais</h3>
    <div class="form-row">
      <div class="form-group">
        <label for="nome_completo">Nome completo*</label>
        <input 
          type="text" 
          id="nome_completo" 
          formControlName="nome_completo" 
          class="form-control"
          [class.is-invalid]="form.get('nome_completo')?.invalid && form.get('nome_completo')?.touched">
        <div class="invalid-feedback" *ngIf="form.get('nome_completo')?.invalid && form.get('nome_completo')?.touched">
          Nome completo é obrigatório
        </div>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="data_nascimento">Data de nascimento*</label>
        <input 
          type="date" 
          id="data_nascimento" 
          formControlName="data_nascimento" 
          class="form-control"
          [class.is-invalid]="form.get('data_nascimento')?.invalid && form.get('data_nascimento')?.touched">
        <div class="invalid-feedback" *ngIf="form.get('data_nascimento')?.invalid && form.get('data_nascimento')?.touched">
          Data de nascimento é obrigatória
        </div>
      </div>
      
      <div class="form-group">
        <label for="cpf">CPF*</label>
        <input 
          type="text" 
          id="cpf" 
          formControlName="cpf" 
          class="form-control"
          [class.is-invalid]="form.get('cpf')?.invalid && form.get('cpf')?.touched">
        <div class="invalid-feedback" *ngIf="form.get('cpf')?.invalid && form.get('cpf')?.touched">
          CPF é obrigatório
        </div>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="genero">Gênero</label>
        <select id="genero" formControlName="genero" class="form-control">
          <option value="">Selecione</option>
          <option *ngFor="let genero of generoOptions" [value]="genero">{{ genero }}</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="estado_civil">Estado Civil</label>
        <select id="estado_civil" formControlName="estado_civil" class="form-control">
          <option value="">Selecione</option>
          <option *ngFor="let estadoCivil of estadoCivilOptions" [value]="estadoCivil">{{ estadoCivil }}</option>
        </select>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="profissao">Profissão</label>
        <input type="text" id="profissao" formControlName="profissao" class="form-control">
      </div>
      
      <div class="form-group">
        <label for="nacionalidade">Nacionalidade</label>
        <input type="text" id="nacionalidade" formControlName="nacionalidade" class="form-control">
      </div>
    </div>
  </div>
  
  <!-- SEÇÃO: CONTATO -->
  <div class="form-section">
    <h3>Contato</h3>
    <div class="form-row">
      <div class="form-group">
        <label for="telefone">Telefone Principal*</label>
        <input 
          type="tel" 
          id="telefone" 
          formControlName="telefone" 
          class="form-control"
          [class.is-invalid]="form.get('telefone')?.invalid && form.get('telefone')?.touched">
        <div class="invalid-feedback" *ngIf="form.get('telefone')?.invalid && form.get('telefone')?.touched">
          Telefone é obrigatório
        </div>
      </div>
      
      <div class="form-group">
        <label for="telefone_secundario">Telefone Secundário</label>
        <input type="tel" id="telefone_secundario" formControlName="telefone_secundario" class="form-control">
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="email">Email</label>
        <input 
          type="email" 
          id="email" 
          formControlName="email" 
          class="form-control"
          [class.is-invalid]="form.get('email')?.invalid && form.get('email')?.touched">
        <div class="invalid-feedback" *ngIf="form.get('email')?.invalid && form.get('email')?.touched">
          Email inválido
        </div>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="contato_emergencia">Contato de Emergência</label>
        <input type="text" id="contato_emergencia" formControlName="contato_emergencia" class="form-control">
      </div>
      
      <div class="form-group">
        <label for="telefone_emergencia">Telefone de Emergência</label>
        <input type="tel" id="telefone_emergencia" formControlName="telefone_emergencia" class="form-control">
      </div>
    </div>
  </div>

  <!-- SEÇÃO: ENDEREÇO -->
  <div class="form-section">
    <h3>Endereço</h3>
    <div class="form-row" formGroupName="endereco">
      <div class="form-group">
        <label for="cep">CEP</label>
        <div class="input-group">
          <input 
            type="text" 
            id="cep" 
            formControlName="cep" 
            class="form-control"
            placeholder="Somente números">
          <button type="button" class="btn btn-outline-primary" (click)="buscarCep()" [disabled]="isLoadingCep">
            <span *ngIf="isLoadingCep" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
            <span *ngIf="!isLoadingCep">Buscar</span>
          </button>
        </div>
      </div>
    </div>
    
    <div class="form-row" formGroupName="endereco">
      <div class="form-group">
        <label for="logradouro">Logradouro</label>
        <input type="text" id="logradouro" formControlName="logradouro" class="form-control">
      </div>
      
      <div class="form-group">
        <label for="numero">Número</label>
        <input type="text" id="numero" formControlName="numero" class="form-control">
      </div>
    </div>
    
    <div class="form-row" formGroupName="endereco">
      <div class="form-group">
        <label for="complemento">Complemento</label>
        <input type="text" id="complemento" formControlName="complemento" class="form-control">
      </div>
      
      <div class="form-group">
        <label for="bairro">Bairro</label>
        <input type="text" id="bairro" formControlName="bairro" class="form-control">
      </div>
    </div>
    
    <div class="form-row" formGroupName="endereco">
      <div class="form-group">
        <label for="cidade">Cidade</label>
        <input type="text" id="cidade" formControlName="cidade" class="form-control">
      </div>
      
      <div class="form-group">
        <label for="estado">Estado</label>
        <input type="text" id="estado" formControlName="estado" class="form-control">
      </div>
    </div>
  </div>
  
  <!-- SEÇÃO: INFORMAÇÕES CLÍNICAS -->
  <div class="form-section">
    <h3>Informações Clínicas</h3>
    <div class="form-row">
      <div class="form-group">
        <label for="status">Status*</label>
        <select 
          id="status" 
          formControlName="status" 
          class="form-control"
          [class.is-invalid]="form.get('status')?.invalid && form.get('status')?.touched">
          <option *ngFor="let status of statusOptions" [value]="status">{{ status }}</option>
        </select>
        <div class="invalid-feedback" *ngIf="form.get('status')?.invalid && form.get('status')?.touched">
          Status é obrigatório
        </div>
      </div>
      
      <div class="form-group">
        <label for="acomodacao">Acomodação*</label>
        <select 
          id="acomodacao" 
          formControlName="acomodacao" 
          class="form-control"
          [class.is-invalid]="form.get('acomodacao')?.invalid && form.get('acomodacao')?.touched">
          <option value="">Selecione</option>
          <option *ngFor="let acomodacao of acomodacaoOptions" [value]="acomodacao">{{ acomodacao }}</option>
        </select>
        <div class="invalid-feedback" *ngIf="form.get('acomodacao')?.invalid && form.get('acomodacao')?.touched">
          Acomodação é obrigatória
        </div>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="cid_primario">CID Primário*</label>
        <input 
          type="text" 
          id="cid_primario" 
          formControlName="cid_primario" 
          class="form-control"
          [class.is-invalid]="form.get('cid_primario')?.invalid && form.get('cid_primario')?.touched">
        <div class="invalid-feedback" *ngIf="form.get('cid_primario')?.invalid && form.get('cid_primario')?.touched">
          CID Primário é obrigatório
        </div>
      </div>
      
      <div class="form-group">
        <label for="cid_secundario">CID Secundário</label>
        <input type="text" id="cid_secundario" formControlName="cid_secundario" class="form-control">
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="medico_responsavel">Médico Responsável</label>
        <input type="text" id="medico_responsavel" formControlName="medico_responsavel" class="form-control">
      </div>
      
      <div class="form-group">
        <label for="case_responsavel">Case Responsável</label>
        <input type="text" id="case_responsavel" formControlName="case_responsavel" class="form-control">
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="alergias">Alergias</label>
        <textarea id="alergias" formControlName="alergias" class="form-control" rows="3"></textarea>
      </div>
    </div>
  </div>
  
  <!-- SEÇÃO: CONVÊNIO -->
  <div class="form-section">
    <h3>Convênio</h3>
    <div class="form-row">
      <div class="form-group">
        <label for="convenio_id">Convênio</label>
        <select 
          id="convenio_id" 
          formControlName="convenio_id" 
          class="form-control"
          (focus)="onConvenioFocus()">
          <option value="">Selecione um convênio</option>
          <option *ngFor="let convenio of convenios" [value]="convenio.id">{{ convenio.nome }}</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="plano_id">Plano</label>
        <select 
          id="plano_id" 
          formControlName="plano_id" 
          class="form-control">
          <option value="">Selecione um plano</option>
          <option *ngFor="let plano of planos" [value]="plano.id">{{ plano.nome }}</option>
        </select>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="numero_carteirinha">Número da Carteirinha</label>
        <input type="text" id="numero_carteirinha" formControlName="numero_carteirinha" class="form-control">
      </div>
      
      <div class="form-group">
        <label for="data_validade">Validade da Carteirinha</label>
        <input type="date" id="data_validade" formControlName="data_validade" class="form-control">
      </div>
    </div>
  </div>
  
  <!-- BOTÕES DE AÇÃO -->
  
</form>