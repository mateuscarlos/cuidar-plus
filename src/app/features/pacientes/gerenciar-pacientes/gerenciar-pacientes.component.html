<div class="container-fluid py-4">
  <!-- Seção de Busca -->
  <div class="card mb-4">
    <div class="card-header bg-primary text-white">
      <h5 class="mb-0">Gerenciar Pacientes</h5>
    </div>
    <div class="card-body">
      <!-- Componente de busca com eventos para editar e visualizar paciente -->
      <app-busca-paciente 
        (resultadoBusca)="buscarPaciente($event)" 
        (pacienteSelecionadoParaEdicao)="selecionarPacienteParaEdicao($event)"
        (pacienteSelecionadoParaVisualizacao)="visualizarPaciente($event)">
      </app-busca-paciente>
    </div>
  </div>

  <!-- Resultados da busca -->
  <!-- Resultados da busca são exibidos no componente app-busca-paciente -->
  <!-- Esta seção foi removida pois estava duplicando a funcionalidade -->

  <!-- Formulário de edição - exibido apenas quando um paciente for selecionado -->
  <div class="card mb-4" *ngIf="pacienteSelecionado">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <h5 class="mb-0">Editar Paciente: {{ pacienteSelecionado.nome }}</h5>
      <button class="btn btn-sm btn-light" (click)="cancelarEdicao()">
        <i class="bi bi-x-lg"></i>
      </button>
    </div>
    <div class="card-body">
      <app-paciente-form 
        #pacienteForm
        *ngIf="pacienteSelecionado" 
        [paciente]="pacienteSelecionado" 
        [isEditMode]="true">
      </app-paciente-form>
    </div>
    <div class="card-footer">
      <div class="d-flex justify-content-between">
        <button class="btn btn-danger" (click)="abrirModalConfirmacao()">
          <i class="bi bi-trash me-2"></i>Excluir
        </button>
        <div>
          <button class="btn btn-secondary me-2" (click)="cancelarEdicao()">
            <i class="bi bi-x-circle me-2"></i>Cancelar
          </button>
          <button class="btn btn-success" (click)="salvarAlteracoes()">
            <i class="bi bi-check-circle me-2"></i>Salvar
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de confirmação de exclusão -->
  <div class="modal fade show" tabindex="-1" role="dialog" style="display: block;" *ngIf="mostrarModal">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-danger text-white">
          <h5 class="modal-title">Confirmar Exclusão</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="fecharModal()"></button>
        </div>
        <div class="modal-body">
          <p>Tem certeza que deseja excluir o paciente <strong>{{ pacienteSelecionado?.nome }}</strong>?</p>
          <p class="text-danger"><strong>Esta ação não poderá ser desfeita.</strong></p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" (click)="fecharModal()">Cancelar</button>
          <button type="button" class="btn btn-danger" (click)="excluirPaciente()">
            <i class="bi bi-trash me-2"></i> Excluir Permanentemente
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-backdrop fade show" *ngIf="mostrarModal"></div>

  <!-- Overlay de carregamento -->
  <div class="loading-overlay d-flex justify-content-center align-items-center" *ngIf="isLoading">
    <div class="text-center">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Carregando...</span>
      </div>
      <p class="mt-2 text-white">Carregando dados do paciente...</p>
    </div>
  </div>
</div>
